## 0. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Å—É—Ç—å

**QMap**¬†‚Äî —ç—Ç–æ —à–∞–±–ª–æ–Ω–Ω—ã–π –∫–ª–∞—Å—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Qt, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π¬†**–∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤**¬†(—Å–ª–æ–≤–∞—Ä—å), —Ö—Ä–∞–Ω—è—â–∏–π –ø–∞—Ä—ã¬†_–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ_¬†—Å —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∏–µ–º –ø–æ –∫–ª—é—á—É.

```cpp
#include <QMap>
QMap<QString, int> map;  // –ö–ª—é—á ‚Äî —Å—Ç—Ä–æ–∫–∞, –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî —Ü–µ–ª–æ–µ
```

‚úÖ¬†**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**:  
–ö–ª–∞—Å—Å –∏–∑ –º–æ–¥—É–ª—è QtCore, –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ (–ª—è–º–±–¥–∞-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π), –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ.
___
## 1. –£—Ä–æ–≤–µ–Ω—å –Ω–æ–≤–∏—á–∫–∞: –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è

### üì¶ –ê–Ω–∞–ª–æ–≥–∏—è —Å –≥–∞—Ä–¥–µ—Ä–æ–±–æ–º

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ¬†**–≥–∞—Ä–¥–µ—Ä–æ–±–Ω—É—é —Å –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —è—á–µ–π–∫–∞–º–∏**.  
–ù–æ–º–µ—Ä–æ–∫ (–∫–ª—é—á) ‚Üí –Ω–æ–º–µ—Ä —è—á–µ–π–∫–∏ (–∑–Ω–∞—á–µ–Ω–∏–µ).

|–†–µ–∞–ª—å–Ω–æ—Å—Ç—å|–ê–Ω–∞–ª–æ–≥–∏—è –≤ QMap|
|---|---|
|–ü–æ–ª—É—á–∏—Ç—å –Ω–æ–º–µ—Ä —è—á–µ–π–∫–∏ –ø–æ –Ω–æ–º–µ—Ä–∫—É|`value(–∫–ª—é—á)`|
|–ü–æ–≤–µ—Å–∏—Ç—å –ø–∞–ª—å—Ç–æ –ø–æ–¥ –Ω–æ–º–µ—Ä 42|`insert(42, "–ø–∞–ª—å—Ç–æ")`|
|–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–Ω—è—Ç –ª–∏ –Ω–æ–º–µ—Ä|`contains(42)`|
|–ü–µ—Ä–µ–±—Ä–∞—Ç—å –≤—Å–µ –≤—ã–¥–∞–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∫–∏|`keys()`|

cpp

QMap<int, QString> wardrobe;
wardrobe.insert(42, "–ü–∞–ª—å—Ç–æ");
wardrobe.insert(13, "–®–ª—è–ø–∞");
qDebug() << wardrobe.value(42); // "–ü–∞–ª—å—Ç–æ"

**–í–∞–∂–Ω–æ**: QMap –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏¬†**—Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª—é—á–∏**¬†(–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é).  
–ù–æ–º–µ—Ä–∫–∏ –≤ –≥–∞—Ä–¥–µ—Ä–æ–±–µ –≤—Å–µ–≥–¥–∞ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã.

---

## 2. –£—Ä–æ–≤–µ–Ω—å –ø—Ä–∞–∫—Ç–∏–∫–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### üõ† –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

cpp

#include <QMap>
#include <QDebug>
QMap<QString, double> prices;
// –í—Å—Ç–∞–≤–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
prices["apple"] = 99.9;
prices.insert("banana", 59.9);
prices["apple"] = 89.9;  // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
// –ü–æ–∏—Å–∫
if (prices.contains("apple")) {
    double p = prices.value("apple");
    // –∏–ª–∏
    double p2 = prices["apple"];  // –æ–ø–∞—Å–Ω–æ: —Å–æ–∑–¥–∞–µ—Ç –∫–ª—é—á –µ—Å–ª–∏ –Ω–µ—Ç!
}
// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å –¥–µ—Ñ–æ–ª—Ç–æ–º
double p = prices.value("orange", -1.0);  // -1 –µ—Å–ª–∏ –Ω–µ—Ç
// –ò—Ç–µ—Ä–∞—Ü–∏—è (–≤ –ø–æ—Ä—è–¥–∫–µ –∫–ª—é—á–µ–π)
for (auto it = prices.begin(); it != prices.end(); ++it) {
    qDebug() << it.key() << "=" << it.value();
}
// C++11 range-based for (Qt 5.2+)
for (const auto& key : prices.keys()) {
    qDebug() << key << prices[key];
}
// –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±
for (auto it = prices.constBegin(); it != prices.constEnd(); ++it) {
    // keys() –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –ª–∏—à–Ω–µ–π –∫–æ–ø–∏–∏ –Ω–µ—Ç
}

### üß© –°–ª–æ–∂–Ω—ã–µ –∫–ª—é—á–∏/–∑–Ω–∞—á–µ–Ω–∏—è

cpp

// –ö–ª—é—á ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç–∏–ø
struct Person {
    QString name;
    int age;
    bool operator<(const Person& other) const {
        if (name != other.name) return name < other.name;
        return age < other.age;
    }
};
QMap<Person, QString> phonebook;
// –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º QPair
QMap<QPair<QString, int>, QString> anotherBook;

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞–º–∏

|–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä|–ü–æ—Ä—è–¥–æ–∫|–°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞|–ü–∞–º—è—Ç—å|–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å|
|---|---|---|---|---|
|**QMap**|üîµ¬†**–£–ø–æ—Ä—è–¥–æ—á–µ–Ω**¬†(–ø–æ –∫–ª—é—á—É)|O(log n)|–£–º–µ—Ä–µ–Ω–Ω–æ|–ù—É–∂–µ–Ω —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ö–æ–¥|
|**QHash**|‚ùå –ù–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω|O(1) —Å—Ä–µ–¥–Ω–∏–π, O(n) —Ö—É–¥—à–∏–π|–ë–æ–ª—å—à–µ (bucket)|–¢–æ–ª—å–∫–æ –ø–æ–∏—Å–∫ –ø–æ –∫–ª—é—á—É|
|**std::map**|–£–ø–æ—Ä—è–¥–æ—á–µ–Ω|O(log n)|–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ|–ï—Å–ª–∏ –Ω–µ Qt –ø—Ä–æ–µ–∫—Ç|
|**std::unordered_map**|–ù–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω|O(1) —Å—Ä–µ–¥–Ω–∏–π|–ë–æ–ª—å—à–µ|STL-–∞–Ω–∞–ª–æ–≥ QHash|

**QHash –±—ã—Å—Ç—Ä–µ–µ**, –Ω–æ QMap¬†**—ç–∫–æ–Ω–æ–º–∏—á–Ω–µ–µ –ø–æ –ø–∞–º—è—Ç–∏**¬†–∏¬†**—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫**.

---

## 3. –£—Ä–æ–≤–µ–Ω—å —ç–∫—Å–ø–µ—Ä—Ç–∞: –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

### üå≥ –ö—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ (Red-Black Tree)

QMap —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ¬†**—Å–∞–º–æ–±–∞–ª–∞–Ω—Å–∏—Ä—É—é—â–µ–≥–æ—Å—è –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –ø–æ–∏—Å–∫–∞**.

text

         [black: 30]
         /          \
   [red: 20]    [black: 40]
    /    \          /    \
 [NIL] [black:25] [NIL] [red: 45]
            \               \
         [red:27]        [NIL]

**–°–≤–æ–π—Å—Ç–≤–∞ –∫—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞:**

1. –ö–∞–∂–¥—ã–π —É–∑–µ–ª –∫—Ä–∞—Å–Ω—ã–π –∏–ª–∏ —á–µ—Ä–Ω—ã–π
    
2. –ö–æ—Ä–µ–Ω—å ‚Äî —á–µ—Ä–Ω—ã–π
    
3. –í—Å–µ –ª–∏—Å—Ç—å—è (NIL) ‚Äî —á–µ—Ä–Ω—ã–µ
    
4. –ö—Ä–∞—Å–Ω—ã–π —É–∑–µ–ª –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∫—Ä–∞—Å–Ω–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è
    
5. –ß–µ—Ä–Ω–∞—è –≤—ã—Å–æ—Ç–∞ ‚Äî –æ–¥–∏–Ω–∞–∫–æ–≤–∞ –¥–ª—è –≤—Å–µ—Ö –ø—É—Ç–µ–π
    

**–ì–∞—Ä–∞–Ω—Ç–∏–∏:**

- –í—Å—Ç–∞–≤–∫–∞: O(log n)
    
- –£–¥–∞–ª–µ–Ω–∏–µ: O(log n)
    
- –ü–æ–∏—Å–∫: O(log n)
    
- –û–±—Ö–æ–¥ inorder: O(n)
    

### üîç –ò—Ç–µ—Ä–∞—Ç–æ—Ä—ã

cpp

class QMapData {
    struct Node {
        Node *left, *right, *parent;
        bool isRed;
        void *key;
        void *value;
    };
    Node *root;
    int refCount;
    // ...
};

**–ò—Ç–µ—Ä–∞—Ç–æ—Ä**¬†‚Äî –æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –Ω–∞ Node.  
**STL-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**¬†–ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏.

### üíé –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

**–î–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞ QMap:**

- –°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–µ—Ç —Ö–µ—à-–∫–æ–ª–ª–∏–∑–∏–π)
    
- –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –æ–±—Ö–æ–¥
    
- –ú–µ–Ω—å—à–µ –æ–≤–µ—Ä—Ö–µ–¥ –ø–æ –ø–∞–º—è—Ç–∏, —á–µ–º QHash —Å –±–æ–ª—å—à–∏–º load factor
    
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–ª—é—á–µ–π (—Ç—Ä–µ–±—É–µ—Ç—Å—è¬†`operator<`)
    

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**

- O(log n) vs O(1) —É QHash
    
- –ö—ç—à-–ø—Ä–æ–º–∞—Ö–∏ (—É–∑–ª—ã —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –≤ –ø–∞–º—è—Ç–∏)
    
- –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ C++11 initializer_list –¥–æ Qt 5.7
    

### üß† –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏

cpp

// –ò–∑–º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∏—Ç–µ—Ä–∞—Ç–æ—Ä ‚Äî –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
auto it = map.find("key");
if (it != map.end()) {
    it.value().modify();  // –µ—Å–ª–∏ value ‚Äî —Å–ª–æ–∂–Ω—ã–π –æ–±—ä–µ–∫—Ç
}
// –£–¥–∞–ª–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –∏—Ç–µ—Ä–∞—Ü–∏–∏
for (auto it = map.begin(); it != map.end(); ) {
    if (it.value() < 0)
        it = map.erase(it);
    else
        ++it;
}
// QMap + std::algorithm
QMap<int, QString> m;
std::transform(m.begin(), m.end(),
               std::inserter(list, list.begin()),
               [](const auto& p) { return p.key() + p.value(); });

### üìö –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

- [Qt 6 QMap](https://doc.qt.io/qt-6/qmap.html)
    
- [Qt 5 QMap](https://doc.qt.io/qt-5/qmap.html)
    
- [–ò—Å—Ç–æ—á–Ω–∏–∫: –ê–ª–≥–æ—Ä–∏—Ç–º—ã (–ö–æ—Ä–º–µ–Ω –∏ –¥—Ä.) ‚Äî Red-Black Trees](https://mitpress.mit.edu/books/introduction-algorithms)