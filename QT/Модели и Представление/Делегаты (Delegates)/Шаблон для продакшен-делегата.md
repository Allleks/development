```cpp
class ProductionDelegate : public QStyledItemDelegate {
    Q_OBJECT
    
public:
    explicit ProductionDelegate(QObject* parent = nullptr);
    
    // Отрисовка
    void paint(QPainter* painter,
               const QStyleOptionViewItem& option,
               const QModelIndex& index) const override;
    
    // Размер
    QSize sizeHint(const QStyleOptionViewItem& option,
                   const QModelIndex& index) const override;
    
    // Редактирование
    QWidget* createEditor(QWidget* parent,
                         const QStyleOptionViewItem& option,
                         const QModelIndex& index) const override;
    
    void setEditorData(QWidget* editor,
                      const QModelIndex& index) const override;
    
    void setModelData(QWidget* editor,
                     QAbstractItemModel* model,
                     const QModelIndex& index) const override;
    
    // Валидация
    bool editorEvent(QEvent* event,
                     QAbstractItemModel* model,
                     const QStyleOptionViewItem& option,
                     const QModelIndex& index) override;
    
    // Подсказки
    bool helpEvent(QHelpEvent* event,
                   QAbstractItemView* view,
                   const QStyleOptionViewItem& option,
                   const QModelIndex& index) override;
    
private:
    // Вспомогательные методы
    QColor calculateColor(const QModelIndex& index) const;
    QString formatValue(const QVariant& value) const;
    
    // Кеширование
    mutable QCache<QModelIndex, QPixmap> m_pixmapCache;
    mutable QCache<QString, QColor> m_colorCache;
};
```